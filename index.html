<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Manajemen Data Periodik SMPN 1 Sukaraja</title>
    <!-- Tailwind CSS CDN -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Font Inter -->
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Inter', sans-serif;
            background-color: #f3f4f6;
            color: #374151;
        }
        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 2rem;
        }
        .form-group label {
            font-weight: 500;
            margin-bottom: 0.5rem;
            display: block;
        }
        .form-group input, .form-group select {
            width: 100%;
            padding: 0.75rem;
            border: 1px solid #d1d5db;
            border-radius: 0.5rem;
            background-color: #ffffff;
            box-shadow: 0 1px 2px 0 rgba(0, 0, 0, 0.05);
        }
        .btn {
            padding: 0.75rem 1.5rem;
            border-radius: 0.5rem;
            font-weight: 600;
            cursor: pointer;
            transition: background-color 0.2s ease-in-out;
        }
        .btn-primary {
            background-color: #4f46e5;
            color: #ffffff;
        }
        .btn-primary:hover {
            background-color: #4338ca;
        }
        .btn-secondary {
            background-color: #6b7280;
            color: #ffffff;
        }
        .btn-secondary:hover {
            background-color: #4b5563;
        }
        .btn-outline {
            background-color: #ffffff;
            color: #4f46e5;
            border: 1px solid #4f46e5;
        }
        .btn-outline:hover {
            background-color: #eef2ff;
        }
        .card {
            background-color: #ffffff;
            border-radius: 0.75rem;
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06);
            padding: 1.5rem;
        }
        .table-container {
            overflow-x: auto;
        }
        table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 1rem;
        }
        th, td {
            padding: 0.75rem;
            text-align: left;
            border-bottom: 1px solid #e5e7eb;
        }
        th {
            background-color: #f9fafb;
            font-weight: 600;
            color: #4b5563;
        }
        tbody tr:hover {
            background-color: #f3f4f6;
        }
        .selected-row {
            background-color: #dbeafe !important; /* Tailwind blue-100 */
        }
        /* Custom Message Box Styles */
        .message-box {
            position: fixed;
            top: 20px;
            left: 50%;
            transform: translateX(-50%);
            background-color: #4CAF50; /* Green for success */
            color: white;
            padding: 15px 25px;
            border-radius: 8px;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
            z-index: 1000;
            opacity: 0;
            transition: opacity 0.3s ease-in-out;
            font-weight: 600;
            text-align: center;
        }
        .message-box.show {
            opacity: 1;
        }
        .message-box.error {
            background-color: #f44336; /* Red for error */
        }
        .loading-overlay, .confirm-modal {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(255, 255, 255, 0.8);
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 1000;
            flex-direction: column;
            gap: 1rem;
        }
        .spinner {
            border: 4px solid rgba(0, 0, 0, 0.1);
            border-left-color: #4f46e5;
            border-radius: 50%;
            width: 40px;
            height: 40px;
            animation: spin 1s linear infinite;
        }
        @keyframes spin {
            to { transform: rotate(360deg); }
        }
        .confirm-modal-content {
            background-color: #ffffff;
            padding: 2rem;
            border-radius: 0.75rem;
            box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.1), 0 4px 6px -2px rgba(0, 0, 0, 0.05);
            text-align: center;
        }
    </style>
    <!-- SheetJS CDN for Excel export -->
    <script src="https://unpkg.com/xlsx/dist/xlsx.full.min.js"></script>
    <!-- Firebase SDKs -->
    <script type="module">
        import { initializeApp } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-app.js";
        import { getAuth, signInWithCustomToken, onAuthStateChanged } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-auth.js";
        import { getFirestore, collection, addDoc, onSnapshot, deleteDoc, doc, query } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-firestore.js";

        // Firebase global variables
        let db;
        let auth;
        let userId;
        let students = [];
        let selectedStudentIds = new Set();
        let authReady = false;

        // Mendeklarasikan variabel elemen di luar fungsi agar bisa diakses global
        let studentForm, tingkatKelasSelect, rombelKelasSelect, jarakSekolahRadios, jarakKmGroup, jarakKmInput, studentTableBody, exportSelectedBtn, messageBox, loadingOverlay, confirmModal, confirmYesBtn, confirmNoBtn;
        let currentDeleteStudentId = null;

        function showMessage(message, type = 'success') {
            messageBox.textContent = message;
            messageBox.className = `message-box show ${type}`;
            messageBox.classList.remove('hidden');
            setTimeout(() => {
                messageBox.classList.remove('show');
                messageBox.classList.add('hidden');
            }, 3000);
        }

        function showLoading() {
            loadingOverlay.classList.remove('hidden');
        }

        function hideLoading() {
            loadingOverlay.classList.add('hidden');
        }

        function populateRombelKelas(tingkat) {
            rombelKelasSelect.innerHTML = '<option value="">Pilih Rombel Kelas</option>';
            rombelKelasSelect.disabled = true;

            if (!tingkat) {
                return;
            }

            rombelKelasSelect.disabled = false;

            let limitChar = '';
            if (tingkat === '7' || tingkat === '8') {
                limitChar = 'J';
            } else if (tingkat === '9') {
                limitChar = 'I';
            }

            for (let charCode = 'A'.charCodeAt(0); charCode <= limitChar.charCodeAt(0); charCode++) {
                const option = document.createElement('option');
                option.value = `${tingkat}${String.fromCharCode(charCode)}`;
                option.textContent = `${tingkat}${String.fromCharCode(charCode)}`;
                rombelKelasSelect.appendChild(option);
            }
        }
        
        function updateJarakKmInput() {
            const selectedJarak = document.querySelector('input[name="jarakSekolah"]:checked').value;
            if (selectedJarak === 'lebihDari1km') {
                jarakKmInput.disabled = false;
                jarakKmInput.setAttribute('required', 'required');
            } else {
                jarakKmInput.disabled = true;
                jarakKmInput.removeAttribute('required');
                jarakKmInput.value = '';
            }
        }
        
        function renderStudentTable() {
            studentTableBody.innerHTML = '';
            if (students.length === 0) {
                const noDataRow = studentTableBody.insertRow();
                noDataRow.innerHTML = '<td colspan="5" class="text-center py-4 text-gray-500">Belum ada data siswa.</td>';
                return;
            }

            students.forEach(student => {
                const row = studentTableBody.insertRow();
                row.classList.add('hover:bg-gray-50', 'transition-colors', 'duration-150');
                if (selectedStudentIds.has(student.id)) {
                    row.classList.add('selected-row');
                }

                const checkboxCell = row.insertCell();
                const checkbox = document.createElement('input');
                checkbox.type = 'checkbox';
                checkbox.className = 'form-checkbox h-5 w-5 text-indigo-600 rounded';
                checkbox.checked = selectedStudentIds.has(student.id);
                checkbox.addEventListener('change', () => {
                    if (checkbox.checked) {
                        selectedStudentIds.add(student.id);
                        row.classList.add('selected-row');
                    } else {
                        selectedStudentIds.delete(student.id);
                        row.classList.remove('selected-row');
                    }
                });
                checkboxCell.appendChild(checkbox);

                row.insertCell().textContent = student.nama;
                row.insertCell().textContent = student.nisn;
                row.insertCell().textContent = student.rombelKelas;

                const actionCell = row.insertCell();
                const deleteBtn = document.createElement('button');
                deleteBtn.textContent = 'Hapus';
                deleteBtn.className = 'text-red-600 hover:text-red-900 font-semibold';
                deleteBtn.addEventListener('click', async () => {
                    if (!authReady) return showMessage('Autentikasi belum siap. Silakan tunggu.', 'error');
                    
                    // Tampilkan modal konfirmasi kustom
                    currentDeleteStudentId = student.id;
                    confirmModal.classList.remove('hidden');
                });
                actionCell.appendChild(deleteBtn);
            });
        }
        
        async function exportToExcel(data, isSelected = false) {
            if (data.length === 0) {
                showMessage('Tidak ada data siswa untuk diekspor.', 'error');
                return;
            }

            const dataToExport = data.map(student => ({
                'Nama Lengkap': student.nama,
                'Jenis Kelamin': student.jenisKelamin,
                'NISN': student.nisn,
                'Rombel Kelas': student.rombelKelas,
                'Tinggi Badan (cm)': student.tinggiBadan,
                'Berat Badan (Kg)': student.beratBadan,
                'Lingkar Kepala (cm)': student.lingkarKepala,
                'Jarak Tempat Tinggal ke Sekolah': student.jarakSekolah === 'kurangDari1km' ? 'Kurang dari 1 km' : 'Lebih dari 1 km',
                'Jarak (km)': student.jarakKm || 'N/A',
                'Waktu Tempuh (Jam)': student.waktuTempuhJam,
                'Waktu Tempuh (Menit)': student.waktuTempuhMenit,
                'Cita-cita': student.citaCita,
                'Hobi': student.hobi,
                'Jumlah Saudara Kandung': student.jumlahSaudaraKandung,
                'Lintang': student.latitude,
                'Bujur': student.longitude,
                'Tempat Tinggal': student.tempatTinggal,
                'Moda Transportasi': student.modaTransportasi,
            }));

            const ws = XLSX.utils.json_to_sheet(dataToExport);
            const wb = XLSX.utils.book_new();
            XLSX.utils.book_append_sheet(wb, ws, "Data Siswa");
            const filename = isSelected ? `Data_Siswa_Terpilih_${new Date().toLocaleDateString('id-ID')}.xlsx` : `Data_Siswa_${new Date().toLocaleDateString('id-ID')}.xlsx`;
            XLSX.writeFile(wb, filename);
            showMessage('Data siswa berhasil diekspor ke Excel!', 'success');
        }

        // Event listener untuk submit form siswa
        
        // Initialize Firebase and set up listener
        window.onload = async () => {
            // Mengambil elemen-elemen DOM di sini, setelah halaman dimuat
            studentForm = document.getElementById('studentForm');
            tingkatKelasSelect = document.getElementById('tingkatKelas');
            rombelKelasSelect = document.getElementById('rombelKelas');
            jarakSekolahRadios = document.querySelectorAll('input[name="jarakSekolah"]');
            jarakKmGroup = document.getElementById('jarakKmGroup');
            jarakKmInput = document.getElementById('jarakKm');
            studentTableBody = document.getElementById('studentTableBody');
            exportSelectedBtn = document.getElementById('exportSelectedBtn');
            messageBox = document.getElementById('messageBox');
            loadingOverlay = document.getElementById('loadingOverlay');
            confirmModal = document.getElementById('confirmModal');
            confirmYesBtn = document.getElementById('confirmYesBtn');
            confirmNoBtn = document.getElementById('confirmNoBtn');

            // Memastikan semua elemen ada sebelum menambahkan listener
            if (studentForm) {
                studentForm.addEventListener('submit', async (e) => {
                    e.preventDefault();

                    if (!authReady) {
                        showMessage('Autentikasi belum siap. Silakan tunggu.', 'error');
                        return;
                    }

                    showLoading();

                    const newStudent = {
                        nama: document.getElementById('nama').value,
                        jenisKelamin: document.getElementById('jenisKelamin').value,
                        nisn: document.getElementById('nisn').value,
                        rombelKelas: document.getElementById('rombelKelas').value,
                        tinggiBadan: parseInt(document.getElementById('tinggiBadan').value),
                        beratBadan: parseInt(document.getElementById('beratBadan').value),
                        lingkarKepala: parseInt(document.getElementById('lingkarKepala').value),
                        jarakSekolah: document.querySelector('input[name="jarakSekolah"]:checked').value,
                        jarakKm: jarakKmInput.disabled ? null : parseInt(document.getElementById('jarakKm').value),
                        waktuTempuhJam: parseInt(document.getElementById('waktuTempuhJam').value),
                        waktuTempuhMenit: parseInt(document.getElementById('waktuTempuhMenit').value),
                        citaCita: document.getElementById('citaCita').value,
                        hobi: document.getElementById('hobi').value,
                        jumlahSaudaraKandung: parseInt(document.getElementById('jumlahSaudaraKandung').value),
                        latitude: document.getElementById('latitude').value,
                        longitude: document.getElementById('longitude').value,
                        tempatTinggal: document.getElementById('tempatTinggal').value,
                        modaTransportasi: document.getElementById('modaTransportasi').value,
                    };

                    if (!newStudent.jenisKelamin || !newStudent.rombelKelas || !newStudent.tempatTinggal || !newStudent.modaTransportasi) {
                        hideLoading();
                        showMessage('Semua kolom wajib diisi.', 'error');
                        return;
                    }

                    try {
                        await addDoc(collection(db, `artifacts/${__app_id}/public/data/students`), newStudent);
                        showMessage('Data siswa berhasil disimpan!', 'success');
                    } catch (error) {
                        showMessage('Gagal menyimpan data. Coba lagi.', 'error');
                        console.error("Error adding document: ", error);
                    }
                    
                    // Ekspor data setelah disimpan
                    exportToExcel([newStudent]);
                    
                    // Bersihkan formulir setelah disimpan
                    studentForm.reset();
                    updateJarakKmInput();
                    populateRombelKelas('');
                    tingkatKelasSelect.value = '';

                    hideLoading();
                });
            }

            if (tingkatKelasSelect) {
                tingkatKelasSelect.addEventListener('change', () => {
                    const selectedTingkat = tingkatKelasSelect.value;
                    populateRombelKelas(selectedTingkat);
                });
            }

            if (jarakSekolahRadios) {
                 jarakSekolahRadios.forEach(radio => {
                    radio.addEventListener('change', updateJarakKmInput);
                });
            }
            
            if (exportSelectedBtn) {
                 exportSelectedBtn.addEventListener('click', () => {
                    const selectedStudentsData = students.filter(s => selectedStudentIds.has(s.id));
                    if (selectedStudentsData.length === 0) {
                        showMessage('Silakan pilih setidaknya satu siswa untuk diekspor.', 'error');
                        return;
                    }
                    exportToExcel(selectedStudentsData, true);
                });
            }

            // Custom confirmation modal logic
            if (confirmYesBtn) {
                confirmYesBtn.addEventListener('click', async () => {
                    if (!currentDeleteStudentId) return;

                    confirmModal.classList.add('hidden');
                    showLoading();

                    try {
                        await deleteDoc(doc(db, `artifacts/${__app_id}/public/data/students`, currentDeleteStudentId));
                        showMessage('Data siswa berhasil dihapus.', 'success');
                    } catch (error) {
                        showMessage('Gagal menghapus data. Coba lagi.', 'error');
                        console.error("Error removing document: ", error);
                    }
                    currentDeleteStudentId = null;
                    hideLoading();
                });
            }

            if (confirmNoBtn) {
                confirmNoBtn.addEventListener('click', () => {
                    confirmModal.classList.add('hidden');
                    currentDeleteStudentId = null;
                });
            }
            
            const firebaseConfig = JSON.parse(typeof __firebase_config !== 'undefined' ? __firebase_config : '{}');
            if (Object.keys(firebaseConfig).length > 0) {
                const app = initializeApp(firebaseConfig);
                db = getFirestore(app);
                auth = getAuth(app);
                
                showLoading();

                onAuthStateChanged(auth, async (user) => {
                    if (user) {
                        userId = user.uid;
                        authReady = true;
                        showMessage(`Autentikasi berhasil: ${userId}`, 'success');
                        
                        // Set up real-time listener for student data
                        const q = query(collection(db, `artifacts/${__app_id}/public/data/students`));
                        onSnapshot(q, (querySnapshot) => {
                            students = [];
                            querySnapshot.forEach((doc) => {
                                students.push({ id: doc.id, ...doc.data() });
                            });
                            renderStudentTable();
                            hideLoading();
                        });
                    } else {
                        try {
                            const initialAuthToken = typeof __initial_auth_token !== 'undefined' ? __initial_auth_token : null;
                            if (initialAuthToken) {
                                await signInWithCustomToken(auth, initialAuthToken);
                            } else {
                                showMessage('Autentikasi gagal. Mohon muat ulang halaman.', 'error');
                            }
                        } catch (error) {
                            showMessage('Autentikasi gagal. Mohon muat ulang halaman.', 'error');
                            console.error("Authentication error: ", error);
                        }
                        hideLoading();
                    }
                });
            } else {
                showMessage('Firebase config tidak ditemukan.', 'error');
            }
            
            updateJarakKmInput();
            populateRombelKelas('');
        };
    </script>
</head>
<body class="bg-gray-100 text-gray-700">
    <div class="container py-8">
        <h1 class="text-4xl font-bold text-center text-indigo-700 mb-8">Manajemen Data Periodik SMPN 1 Sukaraja</h1>

        <!-- Custom Message Box -->
        <div id="messageBox" class="message-box hidden"></div>

        <!-- Loading Overlay -->
        <div id="loadingOverlay" class="loading-overlay hidden">
            <div class="spinner"></div>
            <p class="text-lg text-indigo-700">Menghubungkan ke database...</p>
        </div>

        <!-- Custom Confirmation Modal -->
        <div id="confirmModal" class="confirm-modal hidden">
            <div class="confirm-modal-content">
                <p class="text-xl font-semibold mb-6">Apakah Anda yakin ingin menghapus data ini?</p>
                <div class="flex justify-center space-x-4">
                    <button id="confirmNoBtn" class="btn btn-secondary">Tidak</button>
                    <button id="confirmYesBtn" class="btn btn-primary">Ya, Hapus</button>
                </div>
            </div>
        </div>

        <div class="grid grid-cols-1 lg:grid-cols-2 gap-8">
            <!-- Input Data Siswa -->
            <div class="card">
                <h2 class="text-2xl font-semibold text-indigo-600 mb-6">Input Data Siswa</h2>
                <form id="studentForm" class="space-y-4">
                    <div class="form-group">
                        <label for="nama">Nama Lengkap (Sesuai Ijazah/Akta Kelahiran):</label>
                        <input type="text" id="nama" name="nama" required class="focus:ring-indigo-500 focus:border-indigo-500" placeholder="Masukkan nama lengkap siswa">
                    </div>
                    <div class="form-group">
                        <label for="jenisKelamin">Jenis Kelamin:</label>
                        <select id="jenisKelamin" name="jenisKelamin" required class="focus:ring-indigo-500 focus:border-indigo-500">
                            <option value="">Pilih Jenis Kelamin</option>
                            <option value="Laki-laki">Laki-laki</option>
                            <option value="Perempuan">Perempuan</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label for="nisn">NISN:</label>
                        <input type="text" id="nisn" name="nisn" required class="focus:ring-indigo-500 focus:border-indigo-500" placeholder="Masukkan NISN siswa (contoh: 0012345678)">
                    </div>
                    <div class="form-group">
                        <label for="tingkatKelas">Tingkat Kelas:</label>
                        <select id="tingkatKelas" name="tingkatKelas" required class="focus:ring-indigo-500 focus:border-indigo-500">
                            <option value="">Pilih Tingkat</option>
                            <option value="7">7</option>
                            <option value="8">8</option>
                            <option value="9">9</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label for="rombelKelas">Rombel Kelas:</label>
                        <select id="rombelKelas" name="rombelKelas" required class="focus:ring-indigo-500 focus:border-indigo-500" disabled>
                            <option value="">Pilih Rombel Kelas</option>
                            <!-- Options will be generated dynamically based on Tingkat Kelas -->
                        </select>
                    </div>
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                        <div class="form-group">
                            <label for="tinggiBadan">Tinggi Badan (cm):</label>
                            <input type="number" id="tinggiBadan" name="tinggiBadan" min="0" required class="focus:ring-indigo-500 focus:border-indigo-500" placeholder="Contoh: 155">
                        </div>
                        <div class="form-group">
                            <label for="beratBadan">Berat Badan (Kg):</label>
                            <input type="number" id="beratBadan" name="beratBadan" min="0" required class="focus:ring-indigo-500 focus:border-indigo-500" placeholder="Contoh: 45">
                        </div>
                    </div>
                    <div class="form-group">
                        <label for="lingkarKepala">Lingkar Kepala (cm):</label>
                        <input type="number" id="lingkarKepala" name="lingkarKepala" min="0" required class="focus:ring-indigo-500 focus:border-indigo-500" placeholder="Contoh: 50">
                    </div>
                    <div class="form-group">
                        <label>Jarak tempat tinggal ke sekolah:</label>
                        <div class="flex items-center space-x-4">
                            <label class="inline-flex items-center">
                                <input type="radio" name="jarakSekolah" value="kurangDari1km" checked class="form-radio text-indigo-600">
                                <span class="ml-2">Kurang dari 1 km</span>
                            </label>
                            <label class="inline-flex items-center">
                                <input type="radio" name="jarakSekolah" value="lebihDari1km" class="form-radio text-indigo-600">
                                <span class="ml-2">Lebih dari 1 km</span>
                            </label>
                        </div>
                    </div>
                    <div class="grid grid-cols-2 gap-4">
                        <div class="form-group" id="jarakKmGroup">
                            <label for="jarakKm">Sebutkan (dalam kilometer):</label>
                            <input type="number" id="jarakKm" name="jarakKm" min="1" step="1" class="focus:ring-indigo-500 focus:border-indigo-500" disabled placeholder="Isi jika jarak lebih dari 1 km">
                        </div>
                        <div class="form-group">
                            <label for="waktuTempuhJam">Waktu Tempuh ke sekolah (Jam):</label>
                            <input type="number" id="waktuTempuhJam" name="waktuTempuhJam" min="0" required class="focus:ring-indigo-500 focus:border-indigo-500" placeholder="Contoh: 0 (untuk menit saja)">
                        </div>
                    </div>
                    <div class="form-group">
                        <label for="waktuTempuhMenit">Waktu Tempuh ke sekolah (Menit):</label>
                        <input type="number" id="waktuTempuhMenit" name="waktuTempuhMenit" min="0" max="59" required class="focus:ring-indigo-500 focus:border-indigo-500" placeholder="Contoh: 25">
                    </div>
                    <div class="form-group">
                        <label for="citaCita">Cita-cita:</label>
                        <input type="text" id="citaCita" name="citaCita" class="focus:ring-indigo-500 focus:border-indigo-500" placeholder="Contoh: Dokter, Guru, Polisi">
                    </div>
                    <div class="form-group">
                        <label for="hobi">Hobi:</label>
                        <input type="text" id="hobi" name="hobi" class="focus:ring-indigo-500 focus:border-indigo-500" placeholder="Contoh: Membaca, Bermain bola, Melukis">
                    </div>
                    <div class="form-group">
                        <label for="jumlahSaudaraKandung">Jumlah Saudara Kandung (sesuai Kartu Keluarga):</label>
                        <input type="number" id="jumlahSaudaraKandung" name="jumlahSaudaraKandung" min="0" required class="focus:ring-indigo-500 focus:border-indigo-500" placeholder="Isi 0 jika anak tunggal">
                    </div>
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                        <div class="form-group">
                            <label for="latitude">Lintang (dari Google Map):</label>
                            <input type="text" id="latitude" name="latitude" class="focus:ring-indigo-500 focus:border-indigo-500" placeholder="Contoh: -6.2088">
                        </div>
                        <div class="form-group">
                            <label for="longitude">Bujur (dari Google Map):</label>
                            <input type="text" id="longitude" name="longitude" class="focus:ring-indigo-500 focus:border-indigo-500" placeholder="Contoh: 106.8456">
                        </div>
                    </div>
                    <div class="form-group">
                        <label for="tempatTinggal">Tempat Tinggal:</label>
                        <select id="tempatTinggal" name="tempatTinggal" required class="focus:ring-indigo-500 focus:border-indigo-500">
                            <option value="">Pilih Tempat Tinggal</option>
                            <option value="Bersama orang tua">Bersama orang tua</option>
                            <option value="Wali">Wali</option>
                            <option value="Kos">Kos</option>
                            <option value="Asrama">Asrama</option>
                            <option value="Panti Asuhan">Panti Asuhan</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label for="modaTransportasi">Moda Transportasi:</label>
                        <select id="modaTransportasi" name="modaTransportasi" required class="focus:ring-indigo-500 focus:border-indigo-500">
                            <option value="">Pilih Moda Transportasi</option>
                            <option value="Jalan kaki">Jalan kaki</option>
                            <option value="Kendaraan pribadi">Kendaraan pribadi</option>
                            <option value="Kendaraan Umum/angkot/Pete-pete">Kendaraan Umum/angkot/Pete-pete</option>
                            <option value="Jemputan Sekolah">Jemputan Sekolah</option>
                            <option value="Kereta Api">Kereta Api</option>
                            <option value="Ojek">Ojek</option>
                            <option value="Andong/Bendi/Sado/Dokar/Delman/Beca">Andong/Bendi/Sado/Dokar/Delman/Beca</option>
                            <option value="Perahu penyebrangan/Rakit/Getek">Perahu penyebrangan/Rakit/Getek</option>
                            <option value="Lainnya">Lainnya</option>
                        </select>
                    </div>
                    <div class="flex justify-end space-x-3">
                        <button type="submit" class="btn btn-primary">Simpan & Ekspor ke Excel</button>
                    </div>
                </form>
            </div>

            <!-- Daftar Siswa -->
            <div class="card">
                <h2 class="text-2xl font-semibold text-indigo-600 mb-6">Daftar Siswa</h2>
                <div class="table-container max-h-96 overflow-y-auto">
                    <table id="studentTable" class="min-w-full divide-y divide-gray-200">
                        <thead>
                            <tr>
                                <th class="py-3 px-4">Pilih</th>
                                <th class="py-3 px-4">Nama</th>
                                <th class="py-3 px-4">NISN</th>
                                <th class="py-3 px-4">Kelas</th>
                                <th class="py-3 px-4">Aksi</th>
                            </tr>
                        </thead>
                        <tbody id="studentTableBody" class="bg-white divide-y divide-gray-200">
                            <!-- Student rows will be inserted here -->
                        </tbody>
                    </table>
                </div>
                <div class="flex justify-end mt-4 space-x-3">
                    <button type="button" id="exportSelectedBtn" class="btn btn-primary">Ekspor Data Terpilih</button>
                </div>
            </div>
        </div>
    </div>
</body>
</html>
